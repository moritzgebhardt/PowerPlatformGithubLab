name: Pull Request Release

on:
  pull_request:
    types:
      - closed

jobs:
  release-solution:
    if: github.event.pull_request.merged == true && github.event.pull_request.base.ref == 'main'
    uses: ./.github/workflows/release-solution-to-prod-reusable.yml
    with:
      solution_name: GitHubLabSolution
      BUILD_ENVIRONMENT_URL: https://org9e7ccea6.crm4.dynamics.com
      PRODUCTION_ENVIRONMENT_URL: https://org83701128.crm4.dynamics.com
      CLIENT_ID: 0b249eea-86dd-4163-9c07-d47009a5a4f1
      TENANT_ID: 57cc5cf9-43af-426b-bb89-51f07148ddbe
    secrets:
      envSecret: ${{ secrets.PowerPlatformSPN }}
